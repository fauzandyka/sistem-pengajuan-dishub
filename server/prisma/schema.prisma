generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model refreshToken {
  id          String   @id @unique(map: "RefreshToken_id_key")
  hashedToken String
  userId      String
  revoked     Boolean  @default(false)
  createdAt   DateTime @default(now())
  updateAt    DateTime @default(now())
  user        user     @relation(fields: [userId], references: [id], onDelete: Cascade, map: "RefreshToken_userId_fkey")

  @@index([userId], map: "RefreshToken_userId_fkey")
}

model user {
  id           String         @id @unique(map: "User_id_key")@default(uuid())
  email        String         @unique(map: "User_email_key")
  password     String
  role         user_role      @default(USER)
  createdAt    DateTime       @default(now())
  updateAt     DateTime       @default(now())
  refreshtoken refreshToken[]
}

enum user_role {
  ADMIN
  USER
}

model merk {
  id Int @id @default(autoincrement())
  name String
  kendaraan kendaraan[]
}

model type {
  id Int @id @default(autoincrement())
  name String  
  kendaraan kendaraan[]

}
model jenis {
  id Int @id @default(autoincrement())
  name String  
  kendaraan kendaraan[]

}

model kendaraan {
  id Int @id @default(autoincrement())
  platKendaraan String
  nomorRangka String
  nomorMesin String
  namaPemegang String
  tahun DateTime
  idJenis Int
  jenis jenis  @relation(fields: [idJenis], references: [id], onDelete: Cascade)
  idMerk Int
  merk merk  @relation(fields: [idMerk], references: [id], onDelete: Cascade)
  idType Int
  type type  @relation(fields: [idType], references: [id], onDelete: Cascade)
  detail detail[]
}

model detail {
  id Int @id @default(autoincrement())
  idKendaraan Int 
  kendaraan kendaraan @relation(fields: [idKendaraan], references: [id], onDelete: Cascade)
  idKerusakan Int
  jenisKerusakan jenisKerusakan @relation(fields: [idKerusakan],references: [id])
  kerusakanLainnya String @default("")
  createAt DateTime @default(now())
  updateAt DateTime @default(now())
  status status @default(PROSESS)
}

model jenisKerusakan {
  id Int @id @default(autoincrement())
  name String
  detail detail[]
}

enum status {
  DITOLAK
  SELESAI
  PROSESS
}
